<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Planicchio ğŸ±</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>

<style>
.hidden{display:none}
.pet{animation:float 3s ease-in-out infinite}
@keyframes float{
0%{transform:translateY(0)}
50%{transform:translateY(-10px)}
100%{transform:translateY(0)}
}
.btn{background:#fb923c;color:#fff;padding:12px;border-radius:16px;width:100%;margin-top:8px}
.card{background:#fff;padding:16px;border-radius:16px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
</style>
</head>

<body class="bg-orange-50 text-gray-800">

<!-- PET -->
<div class="fixed bottom-4 right-4 text-center z-50">
  <div class="text-6xl pet cursor-pointer" onclick="petSay()">ğŸ±</div>
  <div id="petText" class="bg-white p-2 rounded shadow text-sm mt-1"></div>
</div>

<!-- START -->
<div id="start" class="min-h-screen flex flex-col items-center justify-center">
  <h1 class="text-4xl font-bold mb-4">PLANICCHIO</h1>

  <div class="grid grid-cols-1 gap-3 w-64">
    <button class="btn" onclick="start('it-en')">ğŸ‡®ğŸ‡¹ Italiano â†’ ğŸ‡¬ğŸ‡§ English</button>
    <button class="btn" onclick="start('pt-it')">ğŸ‡§ğŸ‡· PortuguÃªs â†’ ğŸ‡®ğŸ‡¹ Italiano</button>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden p-4 max-w-xl mx-auto">

  <!-- PROGRESS -->
  <div class="card mb-4">
    <p id="level"></p>
    <div class="w-full bg-gray-300 rounded mt-1">
      <div id="bar" class="bg-green-500 h-2 rounded" style="width:10%"></div>
    </div>
  </div>

  <!-- MISSIONS -->
  <div class="card mb-4">
    <h2 class="font-bold mb-2">ğŸ¯ MissÃµes de hoje</h2>
    <ul id="missions"></ul>
  </div>

  <!-- EXERCISE -->
  <div class="card">
    <p id="prompt" class="font-semibold"></p>
    <p id="help" class="text-sm text-gray-500 mb-2"></p>

    <div id="quiz">
      <button id="a1" class="btn"></button>
      <button id="a2" class="btn"></button>
    </div>

    <div id="write" class="hidden">
      <input id="input" class="border p-2 w-full rounded" placeholder="...">
      <button class="btn" onclick="checkWrite()">OK</button>
    </div>

    <div id="listen" class="hidden">
      <button class="btn" onclick="play()">ğŸ”Š</button>
      <button class="btn" onclick="next()">Continuar</button>
    </div>

    <div id="speak" class="hidden">
      <button class="btn" onclick="speak()">ğŸ¤</button>
      <p id="spoken"></p>
    </div>
  </div>

</div>

<script>
let course=""
let i=0
let xp=0

const content=[
/* ITALIANO â†’ INGLÃŠS */
{course:"it-en",type:"quiz",prompt:"Cosa significa 'Buongiorno'?",help:"Scegli la traduzione corretta",a1:"Good morning",a2:"Good night",c:"Good morning"},
{course:"it-en",type:"write",prompt:"Traduci 'Grazie'",help:"Scrivi in inglese",c:"Thank you"},
{course:"it-en",type:"listen",prompt:"Ascolta e ripeti",help:"Ãˆ una parola di cortesia",c:"Please"},
{course:"it-en",type:"speak",prompt:"Di': Per favore",help:"Parla in inglese",c:"Please"},
{course:"it-en",type:"quiz",prompt:"Come chiedi il conto?",help:"Situazione: ristorante",a1:"The bill, please",a2:"Where is the hotel?",c:"The bill, please"},

/* PORTUGUÃŠS â†’ ITALIANO */
{course:"pt-it",type:"quiz",prompt:"O que significa 'Buongiorno'?",help:"Escolha a opÃ§Ã£o correta",a1:"Bom dia",a2:"Boa noite",c:"Bom dia"},
{course:"pt-it",type:"write",prompt:"Traduza 'Obrigado'",help:"Escreva em italiano",c:"Grazie"},
{course:"pt-it",type:"listen",prompt:"OuÃ§a e entenda",help:"Palavra comum",c:"Per favore"},
{course:"pt-it",type:"speak",prompt:"Fale: Por favor",help:"Diga em italiano",c:"Per favore"},
{course:"pt-it",type:"quiz",prompt:"Como pedir a conta?",help:"SituaÃ§Ã£o: restaurante",a1:"Il conto, per favore",a2:"Dove Ã¨ il bagno?",c:"Il conto, per favore"}
]

const missionsText={
"it-en":["Completa 3 esercizi","Ascolta 1 parola","Parla una frase"],
"pt-it":["Complete 3 exercÃ­cios","OuÃ§a 1 palavra","Fale uma frase"]
}

function start(c){
course=c
startEl.classList.add("hidden")
app.classList.remove("hidden")
missions.innerHTML=missionsText[c].map(m=>`<li>â€¢ ${m}</li>`).join("")
next()
}

function show(e){
quiz.classList.add("hidden")
write.classList.add("hidden")
listen.classList.add("hidden")
speak.classList.add("hidden")

prompt.innerText=e.prompt
help.innerText=e.help

if(e.type==="quiz"){
quiz.classList.remove("hidden")
a1.innerText=e.a1
a2.innerText=e.a2
a1.onclick=()=>check(e.a1,e.c)
a2.onclick=()=>check(e.a2,e.c)
}
if(e.type==="write"){
write.classList.remove("hidden")
input.value=""
input.dataset.c=e.c
}
if(e.type==="listen"){
listen.classList.remove("hidden")
listen.dataset.c=e.c
}
if(e.type==="speak"){
speak.classList.remove("hidden")
speak.dataset.c=e.c
}
}

function next(){
const list=content.filter(x=>x.course===course)
show(list[i%list.length])
}

function check(a,c){
petText.innerText=a===c?"ğŸ˜» Bravo!":"ğŸ˜¿ Ops!"
advance()
}

function checkWrite(){
petText.innerText=input.value===input.dataset.c?"ğŸ˜¸ Perfetto!":"ğŸ˜¿ Quase!"
advance()
}

function play(){
speechSynthesis.speak(new SpeechSynthesisUtterance(listen.dataset.c))
}

function speak(){
const r=new webkitSpeechRecognition()
r.lang=course==="it-en"?"en-US":"it-IT"
r.start()
r.onresult=e=>{
spoken.innerText=e.results[0][0].transcript
petText.innerText="ğŸ˜º Muito bem!"
advance()
}
}

function advance(){
xp+=10
bar.style.width=Math.min(xp,100)+"%"
level.innerText=xp<50?"A1":"A2"
i++
setTimeout(next,500)
}

function petSay(){
petText.innerText="Continua! ğŸ±"
}

const startEl=document.getElementById("start")
</script>

</body>
</html>
